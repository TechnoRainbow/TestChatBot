# RAG Чат-бот для инвестиционного консультирования

## Описание

Система предоставляет консультации по инвестиционным продуктам, используя векторный поиск в базе знаний и генерацию ответов через LLM.

## Технологический стек

- **Backend**: FastAPI
- **LLM**: ProxyAPI (OpenAI GPT-3.5-turbo)
- **Векторная БД**: FAISS (Facebook AI Similarity Search)
- **Эмбеддинги**: sentence-transformers (multilingual)
- **Frontend**: Vanilla HTML/CSS/JavaScript

## Установка и запуск

### Установка зависимостей
```bash
pip install -r requirements.txt
```

### Запуск приложения
```bash
python app.py
```

Приложение будет доступно по адресу: http://localhost:8000

## Структура проекта

```
├── app.py              # FastAPI приложение с RAG пайплайном
├── config.py           # Конфигурация системы
├── llm_client.py       # Клиент для работы с LLM API
├── knowledge_base.py   # Векторная база знаний с FAISS
├── requirements.txt    # Зависимости проекта
└── README.md          # Документация
```

## Архитектура RAG-пайплайна

### Компоненты системы:

1. **Knowledge Base (FAISS)**
   - Векторизация документов с помощью sentence-transformers
   - Индексирование в FAISS для быстрого поиска
   - Поиск по косинусному сходству

2. **LLM Client (ProxyAPI)**
   - Интеграция с OpenAI GPT-3.5-turbo через ProxyAPI
   - Retry логика и обработка ошибок
   - Контекстное формирование промптов

3. **FastAPI Application**
   - REST API для чат-бота
   - Веб-интерфейс для пользователей
   - Мониторинг и health checks

### Поток обработки запроса:

```
Пользователь → FastAPI → Knowledge Base (FAISS) → LLM Client → Ответ
                ↓              ↓                    ↓
            Валидация    Векторный поиск    Генерация ответа
```

## База знаний

Содержит информацию об инвестиционных продуктах:

- Инвестиционные паи и их особенности
- Закрытые паевые инвестиционные фонды (ЗПИФ)
- Процедуры тестирования инвесторов
- Риски и доходность инвестиций
- Погашение и возврат средств

## Примеры запросов

Примеры запросов для тестирования:

1. **"Что такое инвестиционный пай (Пай)?"**
   - Ожидаемый ответ: Определение, права пайщика, учёт в реестре

2. **"Перед покупкой паев нужно пройти тестирование. Что это значит?"**
   - Ожидаемый ответ: Процедура тестирования, 7 вопросов, возможность пересдачи

3. **"Возможно ли вернуть средства из ЗПИФ до прекращения фонда?"**
   - Ожидаемый ответ: Продажа на вторичном рынке, различия для типов инвесторов

## API Документация

### POST /chat
Основной эндпоинт для обработки запросов:

**Запрос:**
```json
{
  "query": "Что такое инвестиционный пай?"
}
```

**Ответ:**
```json
{
  "response": "Инвестиционный пай — это именная ценная бумага...",
  "context_found": true,
  "processing_time": 2.5
}
```

### GET /health
Проверка состояния системы:
```json
{
  "status": "healthy",
  "components": {
    "knowledge_base": {"status": "healthy", "documents": 16},
    "llm_client": {"status": "healthy", "model": "gpt-3.5-turbo"}
  }
}
```

## Мониторинг

Базовые метрики для отслеживания:
- Время ответа системы
- Успешность поиска контекста
- Доступность LLM API
- Количество запросов в единицу времени

## Конфигурация

Основные параметры настраиваются через переменные окружения:
- `PROXYAPI_TOKEN` - токен для доступа к LLM
- `LLM_PROVIDER` - провайдер LLM (по умолчанию: openai)
- `MODEL_NAME` - модель LLM (по умолчанию: gpt-3.5-turbo)
- `HOST`, `PORT` - параметры сервера

---